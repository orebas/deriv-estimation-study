% Benchmark Study: Derivative Estimation Methods
% Template for SIAM SISC or ACM TOMS submission
\documentclass[11pt]{article}

% Essential packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{array}
\usepackage{longtable}  % For tables that span multiple pages
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}
\usepackage{placeins}  % Provides \FloatBarrier for better float control

% Code listings
\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
}

% TODO handling - visible but doesn't break compilation
\newcommand{\TODO}[1]{\textcolor{red}{\textbf{[TODO: #1]}}}
\newcommand{\TODOITEM}{\textcolor{red}{$\blacksquare$~}}

% Math operators
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% Figure path - points to build directory (generated by scripts/03_generate_figures.sh)
\graphicspath{{../build/figures/publication/}}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue,
}

% Title and authors
\title{Benchmark Study of Derivative Estimation Methods:\\
Performance Across Orders and Noise Levels}

\author{
    Oren Bassik\thanks{CUNY Graduate Center, Department of Mathematics, obassik@gradcenter.cuny.edu}
}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
Derivative estimation from noisy data is a fundamental problem across computational science, yet systematic comparative evaluation of methods remains lacking. We present a comprehensive benchmark of 28 derivative estimation methods tested across derivative orders 0--7 (with primary analysis focusing on orders 0--5 for fair comparison), 7 noise levels, and 3 distinct dynamical systems. Our goal is to provide clear, actionable guidance for practitioners.

Key findings include: (1) Gaussian Process Regression (GPR) provides the most robust and accurate performance, consistently ranking as the top method in both low- and high-noise regimes. (2) The optimal method depends critically on the use case: splines like Dierckx-5 are highly competitive for low-noise data, while spectral methods offer a compelling balance of speed and accuracy, and filters like Savitzky-Golay provide a robust, computationally cheap baseline. (3) Derivative order is the dominant difficulty factor, with performance degrading systematically as order increases. We also provide a practitioner's guide to method selection based on the trade-off between speed and accuracy. Our full methodology, analysis, and code are provided to ensure transparency and reproducibility.
\end{abstract}

\tableofcontents
\newpage

%==============================================================================
% NEW PAPER STRUCTURE
%==============================================================================

\input{sections/section1_introduction}
\FloatBarrier
\input{sections/section2_related_work}
\FloatBarrier
\input{sections/section3_methods}
\FloatBarrier
\input{sections/section4_design}
\FloatBarrier
\input{sections/section5_analysis}
\FloatBarrier
\input{sections/section6_conclusion}
\FloatBarrier

%==============================================================================
% APPENDICES
%==============================================================================
\appendix
\input{sections/appendixA_method_catalog_complete}
\input{sections/appendixB_high_order}

%==============================================================================
% OLD PAPER STRUCTURE (DEPRECATED)
%==============================================================================
% \section{Related Work}
% \label{sec:related_work}
% \TODO{Related work section.}

% \input{sections/section3_problem}
% \input{sections/section4_methodology}
% \input{sections/section5_methods}
% \input{sections/section6_results}
% \input{sections/section7_discussion}
% \input{sections/section8_recommendations}
% \input{sections/section9_limitations}
% \input{sections/section10_conclusion}

%==============================================================================
% ACKNOWLEDGMENTS
%==============================================================================
\section*{Acknowledgments}
We thank the developers of GaussianProcesses.jl, Dierckx.jl, FFTW.jl, and scikit-learn for their open-source implementations.
% TODO: Add specific acknowledgments for funding, computational resources, reviewers

%==============================================================================
% BIBLIOGRAPHY
%==============================================================================
\bibliographystyle{plain}
\bibliography{references}
% TODO: Create references.bib file with all citations

%==============================================================================
% APPENDICES (Now correctly structured)
%==============================================================================
% \appendix % This is now at the top of the appendix section

\section{Detailed Results Tables}
\label{app:results}

This appendix contains detailed tables of the mean normalized Root-Mean-Square Error (nRMSE) for all contender methods across all noise levels, for each derivative order from 0 to 5. Each table shows performance across seven noise levels (1e-08 to 2e-02) with the mean across all noise levels in the final column.

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 0 (function approximation): Mean nRMSE across noise levels and methods.}
\label{tab:order_0_results}
\input{../build/tables/publication/tables/order_0_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 1 (first derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_1_results}
\input{../build/tables/publication/tables/order_1_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 2 (second derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_2_results}
\input{../build/tables/publication/tables/order_2_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 3 (third derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_3_results}
\input{../build/tables/publication/tables/order_3_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 4 (fourth derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_4_results}
\input{../build/tables/publication/tables/order_4_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 5 (fifth derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_5_results}
\input{../build/tables/publication/tables/order_5_nrmse.tex}
\end{table}

\input{sections/appendixC_reproducibility}

\end{document}
