% Benchmark Study: Derivative Estimation Methods
% Template for SIAM SISC or ACM TOMS submission
\documentclass[11pt]{article}

% Essential packages
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{array}
\usepackage{longtable}  % For tables that span multiple pages
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage[left=1in,right=1in,top=1in,bottom=1in]{geometry}
\usepackage{placeins}  % Provides \FloatBarrier for better float control

% Code listings
\usepackage{listings}
\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    numbers=left,
    numberstyle=\tiny,
}

% TODO handling - visible but doesn't break compilation
\newcommand{\TODO}[1]{\textcolor{red}{\textbf{[TODO: #1]}}}
\newcommand{\TODOITEM}{\textcolor{red}{$\blacksquare$~}}

% Math operators
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\argmax}{arg\,max}

% Figure path - points to build directory (generated by scripts/03_generate_figures.sh)
\graphicspath{{../build/figures/publication/}}

% Hyperref setup
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    citecolor=blue,
    urlcolor=blue,
}

% Title and authors
\title{High-Order Derivative Estimation from Noisy Data:\\
A Comprehensive Benchmark}

\author{
    Oren Bassik\thanks{CUNY Graduate Center, Department of Mathematics, obassik@gradcenter.cuny.edu}
}

\date{\today}

\begin{document}

\maketitle

\begin{abstract}
Estimating derivatives from noisy data is a fundamental but notoriously ill-posed problem across computational science. Despite decades of work on filters, splines, spectral methods, and regularization, there is little systematic evidence comparing these approaches at higher derivative orders. We address this gap with a comprehensive benchmark of 28 derivative estimation methods evaluated on derivative orders 0--7 (with primary emphasis on 1--5) across seven noise levels and three dynamical systems with analytic ground truth.

Our main finding is that Approximant--AD methods---two-step pipelines that first fit a smooth approximant to noisy data, then differentiate it via automatic differentiation---dominate the performance landscape. In particular, Gaussian Process regression combined with Taylor-mode AD in Julia delivers the most robust and accurate performance across all derivative orders and noise regimes, clearly outperforming classical spectral, spline, and filtering methods. Spline-based methods (e.g., Dierckx-5) are highly competitive in low-noise settings, while Savitzky--Golay and related filters offer fast, robust baselines when computational budget is tight. Across all methods, derivative order is the primary driver of difficulty: performance degrades sharply beyond 3rd--5th order, and only a handful of methods produce usable estimates at 6th--7th order.

We provide a practitioner-oriented method selection guide and release all code, data, and analysis scripts to ensure full reproducibility and support future extensions of this benchmark.
\end{abstract}

\tableofcontents
\newpage

%==============================================================================
% NEW PAPER STRUCTURE
%==============================================================================

\input{sections/section1_introduction}
\FloatBarrier
\input{sections/section2_related_work}
\FloatBarrier
\input{sections/section3_methods}
\FloatBarrier
\input{sections/section4_design}
\FloatBarrier
\input{sections/section5_analysis}
\FloatBarrier
\input{sections/section6_conclusion}
\FloatBarrier

%==============================================================================
% APPENDICES
%==============================================================================
\appendix
\input{sections/appendixA_method_catalog_complete}
\input{sections/appendixB_high_order}

%==============================================================================
% OLD PAPER STRUCTURE (DEPRECATED)
%==============================================================================
% \section{Related Work}
% \label{sec:related_work}
% \TODO{Related work section.}

% \input{sections/section3_problem}
% \input{sections/section4_methodology}
% \input{sections/section5_methods}
% \input{sections/section6_results}
% \input{sections/section7_discussion}
% \input{sections/section8_recommendations}
% \input{sections/section9_limitations}
% \input{sections/section10_conclusion}

%==============================================================================
% ACKNOWLEDGMENTS
%==============================================================================
\section*{Acknowledgments}
We thank the developers of GaussianProcesses.jl, Dierckx.jl, FFTW.jl, and scikit-learn for their open-source implementations.
% TODO: Add specific acknowledgments for funding, computational resources, reviewers

%==============================================================================
% BIBLIOGRAPHY
%==============================================================================
\bibliographystyle{plain}
\bibliography{references}
% TODO: Create references.bib file with all citations

%==============================================================================
% APPENDICES (Now correctly structured)
%==============================================================================
% \appendix % This is now at the top of the appendix section

\section{Detailed Results Tables}
\label{app:results}

This appendix contains detailed tables of the mean normalized Root-Mean-Square Error (nRMSE) for all contender methods across all noise levels, for each derivative order from 0 to 5. Each table shows performance across seven noise levels (1e-08 to 2e-02) with the mean across all noise levels in the final column.

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 0 (function approximation): Mean nRMSE across noise levels and methods.}
\label{tab:order_0_results}
\input{../build/tables/publication/tables/order_0_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 1 (first derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_1_results}
\input{../build/tables/publication/tables/order_1_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 2 (second derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_2_results}
\input{../build/tables/publication/tables/order_2_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 3 (third derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_3_results}
\input{../build/tables/publication/tables/order_3_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 4 (fourth derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_4_results}
\input{../build/tables/publication/tables/order_4_nrmse.tex}
\end{table}

\begin{table}[!ht]
\centering
\small
\caption{Derivative Order 5 (fifth derivative): Mean nRMSE across noise levels and methods.}
\label{tab:order_5_results}
\input{../build/tables/publication/tables/order_5_nrmse.tex}
\end{table}

\input{sections/appendixC_reproducibility}

\end{document}
